<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Event Source</title>
  </head>
  <body>
    <script>
      if (window.EventSource) {
        const serverListener = new EventSource('server.php');

        serverListener.addEventListener('open', (ev) => {
          console.log('La conexion se ha establecido');
        }, false);

        serverListener.addEventListener('error', (ev) => {
          if (ev.readyState === EventSource.CLOSED) {
            console.log('El servidor ha cerrado la conexion');
          } else {
            console.log(ev);
          }
        }, false);

        serverListener.addEventListener('message', (ev) => {
          console.log(ev.data);
        }, false);

        serverListener.addEventListener('evento', (ev) => {
          console.log(ev.data); 
        }, false);
      }
    </script>
  </body>
</html>
